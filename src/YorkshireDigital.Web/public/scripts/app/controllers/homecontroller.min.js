!function(){"use strict";function t(t,n,e,o){function r(){t.to_trusted=function(t){return n.trustAsHtml(t)},t.clndrNextMonth=function(){console.log("clndrNextMonth"),t.clndr.forward();var n=moment(t.clndr.month._d).date(1).add(1,"M").format("DD/MM/YYYY"),e=moment(t.clndr.month._d).date(1).add(2,"M").format("DD/MM/YYYY");t.loadEvents(n,e,function(n){t.addNewEvents(n)})},t.clndrPreviousMonth=function(){console.log("clndrPreviousMonth"),t.clndr.back();var n=moment(t.clndr.month._d).date(1).subtract(1,"M").format("DD/MM/YYYY"),e=moment(t.clndr.month._d).date(1).format("DD/MM/YYYY");t.loadEvents(n,e,function(n){t.addNewEvents(n)})},t.addNewEvents=function(n){for(var e=[],o=n.length-1;o>=0;o--){for(var r=!1,a=0;a<t.events.length;a++)n[o].uniqueName==t.events[a].uniqueName&&(r=!0);r===!1&&(e.push(n[o]),t.events.push(n[o]))}return t.populateFilters(e),t.clndr.addEvents(e),e},t.loadEvent=function(n){e.Events.get({eventId:n},function(n){t.activeEvent=n})},t.loadEvents=function(t,n,o){e.Calendar.query({from:t,to:n},o)},t.populateFilters=function(n){for(var e=t.interests||[],o=t.locations||[],r=n.length-1;r>=0;r--){for(var a=n[r].interests.length-1;a>=0;a--)-1===$.inArray(n[r].interests[a],e)&&e.push(n[r].interests[a]);-1===$.inArray(n[r].location,o)&&o.push(n[r].location)}t.interests=e,t.locations=o,t.search=t.search||{interests:"",location:""}}}r(),t.title="homeController",o.eventName&&t.loadEvent(o.eventName);var a=moment().date(1).subtract(1,"M").format("DD/MM/YYYY"),s=moment().date(1).add(2,"M").format("DD/MM/YYYY");t.loadEvents(a,s,function(n){t.events=n,t.populateFilters(n)})}window.app.controller("homeController",["$scope","$sce","calendarService","$routeParams",t])}();